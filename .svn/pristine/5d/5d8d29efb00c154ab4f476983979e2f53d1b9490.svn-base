webpackJsonp([6],{XrBh:function(e,t){},eVK9:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o("BO1k"),a=o.n(r),l=o("mvHQ"),s=o.n(l),i=o("OpVI"),n={data:function(){return{activeNames:"",keyinput:"",tableData:[],ruleForm:{rolecode:"",rolename:"",adjust:"",download:"",reportcode:"",menucode:""},tempruleForm:{rolecode:"",rolename:"",adjust:!1,download:!1,reportcode:"",menucode:""},rules:{rolecode:[{required:!0,message:"请输入角色编码",trigger:"blur"},{message:"请输入字母下划线数字的组合",trigger:"blur,change",pattern:/^[0-9a-zA-Z_]{1,}$/}],rolename:[{required:!0,message:"请输入角色名称",trigger:"change"}]},dialogFormVisible:!1,data:[],datamenu:[],defaultProps:{children:"subList",label:"rtpCataName"},defaultPropsmenu:{label:"privilegeMenuName",children:"subList"},offset:0,pageSize:10,selectdata:[],total:0,addoredit:!0,selectreport:[],selectmenu:[]}},mounted:function(){this.Getdata(),this.reprotInit(),this.queryAllMenu()},methods:{Getdata:function(){var e=this,t={keyword:this.keyinput,offset:this.offset,pageSize:this.pageSize};Object(i.v)(t).then(function(t){console.log("keyword",t),"0"===t.code&&(e.tableData=t.data.rows,e.total=t.data.total)})},handleSelectionChange:function(e){this.selectdata=JSON.parse(s()(e))},delopen:function(){var e=this,t=[],o=!0,r=!1,l=void 0;try{for(var s,n=a()(this.selectdata);!(o=(s=n.next()).done);o=!0){var c=s.value;t.push(c.id)}}catch(e){r=!0,l=e}finally{try{!o&&n.return&&n.return()}finally{if(r)throw l}}Object(i.h)(t).then(function(t){"0"===t.code&&e.Getdata()})},currentpagechange:function(e){this.offset=e,this.Getdata()},Checktreedata:function(e,t,o){var r=this.$refs.treedata.getCheckedKeys();this.selectreport=JSON.parse(s()(r)),this.ruleForm.reportcode="";var l=!0,i=!1,n=void 0;try{for(var c,u=a()(this.selectreport);!(l=(c=u.next()).done);l=!0){var d=c.value;8===d.length&&(""===this.ruleForm.reportcode?this.ruleForm.reportcode=""+d:this.ruleForm.reportcode=this.ruleForm.reportcode+","+d)}}catch(e){i=!0,n=e}finally{try{!l&&u.return&&u.return()}finally{if(i)throw n}}},Checktreemenu:function(e,t,o){var r=this.$refs.treemenu.getCheckedKeys();this.selectmenu=JSON.parse(s()(r)),console.log("this.selectmenu",this.selectmenu),this.ruleForm.menucode=this.selectmenu.join(",")},reprotInit:function(){var e=this;Object(i.y)().then(function(t){console.log("报表树接口-res",t),"0"===t.code&&(e.data=t.data)})},queryAllMenu:function(){var e=this;Object(i.x)().then(function(t){console.log("目录树接口-res",t),"0"===t.code&&(e.datamenu=t.data)})},Adddata:function(){var e=this,t=JSON.parse(s()(this.ruleForm));console.log("this.ruleForm",this.ruleForm),Object(i.b)(t).then(function(t){"0"===t.code&&(e.Getdata(),e.$refs.treemenu.setCheckedKeys([]),e.$refs.treedata.setCheckedKeys([]))})},Editdata:function(){var e=this,t=JSON.parse(s()(this.ruleForm));Object(i.j)(t).then(function(t){"0"===t.code&&(e.Getdata(),e.$refs.treemenu.setCheckedKeys([]),e.$refs.treedata.setCheckedKeys([]))})},addopen:function(){var e=this;this.dialogFormVisible=!0,this.addoredit=!0,this.ruleForm=JSON.parse(s()(this.tempruleForm)),this.$nextTick(function(){e.$refs.treemenu.setCheckedKeys([]),e.$refs.treedata.setCheckedKeys([])})},edit:function(e){var t=this;for(var o in this.addoredit=!1,this.dialogFormVisible=!0,this.ruleForm=JSON.parse(s()(this.tempruleForm)),e)"true"===e[o]?this.ruleForm[o]=!0:"false"===e[o]?this.ruleForm[o]=!1:this.ruleForm[o]=e[o];this.$nextTick(function(){console.log("this.$refs.treemenu",t.$refs.treemenu),""===t.ruleForm.menucode?t.$refs.treemenu.setCheckedKeys([]):t.$refs.treemenu.setCheckedKeys(t.ruleForm.menucode.split(",")),""===t.ruleForm.reportcode?t.$refs.treedata.setCheckedKeys([]):t.$refs.treedata.setCheckedKeys(t.ruleForm.reportcode.split(","))})},querydata:function(){this.Getdata()},submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.dialogFormVisible=!1,t.addoredit?t.Adddata():t.Editdata()})},resetForm:function(e){this.dialogFormVisible=!1}}},c={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"rolemanagerbox"},[o("div",{staticClass:"querybox"},[e._m(0),e._v(" "),o("div",{staticClass:"inputbox"},[o("el-input",{attrs:{placeholder:"请输入关键字查询"},model:{value:e.keyinput,callback:function(t){e.keyinput=t},expression:"keyinput"}}),e._v(" "),o("el-button",{staticClass:"querybtn",on:{click:e.querydata}},[e._v("查询")])],1)]),e._v(" "),o("div",{staticClass:"tablebox"},[o("div",{staticClass:"pagetitle"},[o("span",{staticClass:"titletext"},[e._v("查看/编辑角色信息")]),e._v(" "),o("div",{staticClass:"btngroup"},[o("el-button",{on:{click:e.addopen}},[e._v("新增")]),e._v(" "),o("el-button",{on:{click:e.delopen}},[e._v(" 删除")])],1)]),e._v(" "),o("div",{staticClass:"eletable"},[o("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,border:""},on:{"selection-change":e.handleSelectionChange}},[o("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),o("el-table-column",{attrs:{prop:"rolecode",label:"角色编码",type:"text",size:"small","show-overflow-tooltip":""}}),e._v(" "),o("el-table-column",{attrs:{prop:"rolename",label:"角色名称",type:"text",size:"small","show-overflow-tooltip":""}}),e._v(" "),o("el-table-column",{attrs:{prop:"adjust",label:"调整",width:"80"}}),e._v(" "),o("el-table-column",{attrs:{prop:"download",label:"下载",width:"80"}}),e._v(" "),o("el-table-column",{attrs:{prop:"reportcode",label:"报表编码","show-overflow-tooltip":""}}),e._v(" "),o("el-table-column",{attrs:{prop:"menucode",label:"目录编码","show-overflow-tooltip":""}}),e._v(" "),o("el-table-column",{attrs:{label:"操作",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{attrs:{type:"text",size:"small"},on:{click:function(o){e.edit(t.row)}}},[e._v("修改")])]}}])})],1),e._v(" "),o("div",{staticClass:"paginationbox"},[o("el-pagination",{attrs:{total:e.total,"current-page":e.offset,"page-size":e.pageSize,layout:"total, prev, pager, next, jumper"},on:{"current-change":e.currentpagechange}})],1)],1)]),e._v(" "),o("el-dialog",{attrs:{title:"新增",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[o("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"120px"}},[o("el-form-item",{attrs:{label:"角色编码",prop:"rolecode"}},[o("el-input",{model:{value:e.ruleForm.rolecode,callback:function(t){e.$set(e.ruleForm,"rolecode",t)},expression:"ruleForm.rolecode"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"角色名称",prop:"rolename"}},[o("el-input",{model:{value:e.ruleForm.rolename,callback:function(t){e.$set(e.ruleForm,"rolename",t)},expression:"ruleForm.rolename"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"调整权限",prop:"adjust"}},[o("el-switch",{attrs:{"on-color":"#13ce66","off-color":"#ff4949"},model:{value:e.ruleForm.adjust,callback:function(t){e.$set(e.ruleForm,"adjust",t)},expression:"ruleForm.adjust"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"下载权限",prop:"download"}},[o("el-switch",{attrs:{"on-color":"#13ce66","off-color":"#ff4949"},model:{value:e.ruleForm.download,callback:function(t){e.$set(e.ruleForm,"download",t)},expression:"ruleForm.download"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"报表权限"}},[o("el-collapse",{attrs:{accordion:""},model:{value:e.activeNames,callback:function(t){e.activeNames=t},expression:"activeNames"}},[o("el-collapse-item",{attrs:{name:"1"}},[o("template",{slot:"title"},[o("el-input",{model:{value:e.ruleForm.reportcode,callback:function(t){e.$set(e.ruleForm,"reportcode",t)},expression:"ruleForm.reportcode"}})],1),e._v(" "),o("div",[o("el-tree",{ref:"treedata",attrs:{data:e.data,"show-checkbox":"","node-key":"rtpCataId",props:e.defaultProps},on:{"check-change":e.Checktreedata}})],1)],2)],1)],1),e._v(" "),o("el-form-item",{attrs:{label:"目录权限"}},[o("el-collapse",{attrs:{accordion:""},model:{value:e.activeNames,callback:function(t){e.activeNames=t},expression:"activeNames"}},[o("el-collapse-item",{attrs:{name:"2"}},[o("template",{slot:"title"},[o("el-input",{model:{value:e.ruleForm.menucode,callback:function(t){e.$set(e.ruleForm,"menucode",t)},expression:"ruleForm.menucode"}})],1),e._v(" "),o("div",[o("el-tree",{ref:"treemenu",attrs:{data:e.datamenu,"show-checkbox":"","node-key":"privilegeMenuId",props:e.defaultPropsmenu},on:{"check-change":e.Checktreemenu}})],1)],2)],1)],1)],1),e._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.resetForm("ruleForm")}}},[e._v("取 消")]),e._v(" "),o("el-button",{on:{click:function(t){e.submitForm("ruleForm")}}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"pagetitle"},[t("span",{staticClass:"titletext"},[this._v("查询条件")])])}]};var u=o("VU/8")(n,c,!1,function(e){o("XrBh")},null,null);t.default=u.exports}});
//# sourceMappingURL=6.11c7a87109e4e029df22.js.map